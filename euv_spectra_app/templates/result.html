{% extends 'base.html' %}
{% set active_page = "none" %}
{% block title %}Results{% endblock %}
{% block content %}
    {% include 'partials/loading_screen.html' %}

    <div>
        <img src="{{ url_for('static', filename='imgs/search_bar_bg.png') }}" alt="" class="full-width img img-fluid" id="about-hero-img">
        
        <div class="row pt-5">
            <div class="col-md-2 offset-md-1 pt-4">
                <h5 style="color: white;">Start a New Search</h5>
            </div>
            <div class="col-md-7">
                {% include 'partials/search_bar.html' %}
            </div>
        </div>
    </div>

    <h3 class="mt-5 pt-4 text-center">Closest Match PHOENIX Model for <i>{{ session['search_term'] }}</i></h3>
    <a data-bs-toggle="modal" data-bs-target="#myModal" class="text-center"><p>Click Here to Edit Parameters</p></a>
    <div class="text-center"><small>Model Parameters : Teff = {{ subtype.teff }}, log(g) = {{ subtype.logg }}, Mass = {{ subtype.mass }}</small></div>
    <div class="text-center"><small>Your Parameters : Teff = {{ session.teff }}, log(g) = {{ session.logg }}, Mass = {{ session.mass }}</small></div>
    <div class="text-center mt-2"><small>GALEX Flux Densities<sup>*</sup> for {{ session['search_term'] }}: FUV = {{ "%.2f"|format(session.corrected_fuv) }} +/- {{ "%.2f"|format(session.corrected_fuv_err) }}, NUV = {{ "%.2f"|format(session.corrected_nuv) }} +/- {{ "%.2f"|format(session.corrected_nuv_err) }}</small></div>
    <div class="mt-2 text-center">{{ graph|safe }}</div>

    <div class="row mt-3">
        <div class="col-md-4 d-flex justify-content-center"><button class="btn btn-primary mb-2 small" id="flux-continue-btn"><i class="fa-solid fa-file-arrow-down"></i> <small> Download Spectrum 1<i>(Best Match)</i></small></button></div>
        <div class="col-md-4 d-flex justify-content-center"><button class="btn btn-primary mb-2 small" id="flux-continue-btn"><i class="fa-solid fa-file-arrow-down"></i> <small> Download Spectrum 2</small></button></div>
        <div class="col-md-4 d-flex justify-content-center"><button class="btn btn-primary mb-2 small" id="flux-continue-btn"><i class="fa-solid fa-file-arrow-down"></i> <small> Download Spectrum 3</small></button></div>
    </div>

    <small>NOTES: <br> *In units of ergs/s/cm<sup>2</sup>/â„«, scaled to stellar surface and corrected for photospheric contribution.</small>

    {% include 'partials/modal.html' %}
{% endblock %}

{% block script %}
    <script>
        $(".alert").fadeTo(5000, 500).fadeOut(500, function(){
            $(".alert").fadeOut(500);
        });
    </script>

    <script src="{{ url_for('static', filename='js/autocomplete.js' )}}"></script>
    <script>
        console.log('autocomplete loaded in')
        var data = JSON.parse('{{ targets | tojson }}');
        autocomplete(document.getElementById("name-form-input-group"), data);
    </script>
{% endblock %}